<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />

  <title>wakeup ui</title>

  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body>
  <div class="w-screen h-screen flex items-center justify-center">
    <div class="max-w-sm flex flex-col justify-center gap-4">
      <input class="rounded-2xl border border-gray-300 py-2 px-4 w-full" id="password" type="password"
        placeholder="Password" />

      <div class="flex flex-col items-center gap-2">
        <button class="px-6 py-1.5 text-white w-min bg-gray-900 disabled:opacity-25 text-center rounded-full"
          id="connect">
          Connect
        </button>
        <button disabled class="px-6 py-1.5 text-white w-min bg-blue-500 disabled:opacity-25 text-center rounded-full"
          id="ring">
          Ring
        </button>
      </div>
    </div>
  </div>

  <script>
    let ws;

    const connectButton = document.querySelector("#connect");
    const ringButton = document.querySelector("#ring");

    const connect = () => {
      const password = document.querySelector("#password").value.trim();
      if (!password) {
        alert("Enter password");

        return;
      }

      const url = `ws://${location.host}/ws?password=${password}`;

      ws = new WebSocket(url);

      ws.addEventListener("open", () => {
        console.log("WebSocket connected");

        connectButton.disabled = true;
        ringButton.disabled = false;
      });

      ws.addEventListener("error", () => {
        alert("Connection failed: wrong password or server offline");
      });

      ws.addEventListener("close", () => {
        console.log("WebSocket disconnected");

        connectButton.disabled = false;
        ringButton.disabled = true;
      });

      ws.addEventListener("message", (event) => {
        console.log("Message from server:", event.data);
      });
    };

    const ring = () => {
      if (!ws || ws.readyState !== WebSocket.OPEN) {
        alert("WebSocket not connected");
        return;
      }

      ws.send("ring");
    };

    connectButton.addEventListener("click", connect);
    ringButton.addEventListener("click", ring);
  </script>
</body>

</html>
